# Model Configuration

model:
  name: "GazeAwareVisionModel"
  
  vision_encoder:
    model_name: "vit_base_patch16_224"
    embed_dim: 512
    pretrained: true
    freeze_backbone: false
  
  gaze_encoder:
    input_dim: 3
    embed_dim: 512
    hidden_dims: [64, 128, 256]
    dropout: 0.1
  
  fusion:
    vision_dim: 512
    gaze_dim: 512
    output_dim: 1024
    fusion_method: "concat"  # Options: concat, add, multiply
  
  attention:
    embed_dim: 1024
    num_heads: 8
    dropout: 0.1

gaze_predictor:
  name: "GazePredictor"
  input_channels: 3
  base_channels: 64
  output_dim: 3
  dropout: 0.2

temporal_predictor:
  name: "TemporalGazePredictor"
  input_dim: 3
  hidden_dim: 128
  num_layers: 2
  prediction_horizon: 5
  dropout: 0.2

training:
  epochs: 100
  batch_size: 64
  learning_rate: 0.001
  weight_decay: 0.0001
  scheduler:
    type: "cosine"
    warmup_epochs: 5
    eta_min: 0.00001
  
  optimizer:
    type: "adamw"
    betas: [0.9, 0.999]
    eps: 1e-8
  
  loss:
    gaze_loss: "mse"
    gaze_weight: 1.0
    angular_weight: 0.5

data:
  dataset: "openeds2020"
  image_size: 224
  eye_image_size: 64
  num_workers: 4
  pin_memory: true
  
  augmentation:
    random_crop: true
    random_flip: true
    color_jitter: true
    normalize:
      mean: [0.485, 0.456, 0.406]
      std: [0.229, 0.224, 0.225]

inference:
  device: "cuda"  # Options: cuda, cpu
  batch_size: 1
  use_amp: false  # Automatic Mixed Precision
  
  optimization:
    quantization: false
    pruning: false
    snn_conversion: false

checkpoint:
  save_dir: "checkpoints"
  save_frequency: 5
  keep_last_n: 3

logging:
  use_wandb: true
  project_name: "gaze-aware-vision"
  log_frequency: 10
  save_predictions: true
